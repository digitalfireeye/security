
powershell
Copy code
# Define the time range for the events you want to check (in minutes).  Best for DDos attacks or SYN flood attacks
$TimeRange = 60

# Define the Event IDs that could indicate potential malicious activity. Add more IDs based on what programs to look out
$MaliciousEventIDs = @(4624, 4648, 4688)

# Get the current date and time
$CurrentTime = Get-Date

# Calculate the start time for the event query
$StartTime = $CurrentTime.AddMinutes(-$TimeRange)

# Query the Security Event Log for the specified Event IDs in the defined time range
$MaliciousEvents = Get-WinEvent -LogName Security -FilterHashtable @{
    LogName = 'Security'
    StartTime = $StartTime
    ID = $MaliciousEventIDs
} | Select-Object TimeCreated, Id, Message

# Display the detected malicious events
if ($MaliciousEvents) {
    Write-Host "Potentially malicious events detected:"
    $MaliciousEvents | ForEach-Object {
        Write-Host "Event ID: $($_.Id) | Time: $($_.TimeCreated) | Message: $($_.Message)"
    }
} else {
    Write-Host "No potentially malicious events detected."
}
In this script:

Adjust the $TimeRange variable to set the time range in which you want to check for events.
Modify the $MaliciousEventIDs array to include the Event IDs that you consider potentially malicious.
The script queries the Security Event Log for events with the specified Event IDs within the defined time range.
If any potentially malicious events are found, they will be displayed.
